sklearn_1_1_linear_models
1.1. Linear Models
modules/linear_model.html
 1.1.12. Generalized Linear Regression  Generalized Linear Models (GLM) extend linear models in two ways 10 . First, the predicted values are linked to a linear combination of the input variables via an inverse link function as \[\hat{y}(w, X)  h(Xw).\] Secondly, the squared loss function is replaced by the unit deviance of a distribution in the exponential family (or more precisely, a reproductive exponential dispersion model (EDM) 11 ). The minimization problem becomes: \[\min_{w} \frac{1}{2 n_{\text{samples}}} \sum_i d(y_i, \hat{y}_i) + \frac{\alpha}{2} ||w||_2,\] where is the L2 regularization penalty. When sample weights are provided, the average becomes a weighted average. The following table lists some specific EDMs and their unit deviance (all of these are instances of the Tweedie family): Distribution Target Domain Unit Deviance Normal Poisson Gamma Inverse Gaussian The Probability Density Functions (PDF) of these distributions are illustrated in the following figure, PDF of a random variable Y following Poisson, Tweedie (power1.5) and Gamma distributions with different mean values ( ). Observe the point mass at for the Poisson distribution and the Tweedie (power1.5) distribution, but not for the Gamma distribution which has a strictly positive target domain.  The choice of the distribution depends on the problem at hand: If the target values are counts (non-negative integer valued) or relative frequencies (non-negative), you might use a Poisson deviance with log-link. If the target values are positive valued and skewed, you might try a Gamma deviance with log-link. If the target values seem to be heavier tailed than a Gamma distribution, you might try an Inverse Gaussian deviance (or even higher variance powers of the Tweedie family). Examples of use cases include: Agriculture / weather modeling: number of rain events per year (Poisson), amount of rainfall per event (Gamma), total rainfall per year (Tweedie / Compound Poisson Gamma). Risk modeling / insurance policy pricing: number of claim events / policyholder per year (Poisson), cost per event (Gamma), total cost per policyholder per year (Tweedie / Compound Poisson Gamma). Predictive maintenance: number of production interruption events per year (Poisson), duration of interruption (Gamma), total interruption time per year (Tweedie / Compound Poisson Gamma). References: 10 McCullagh, Peter; Nelder, John (1989). Generalized Linear Models, Second Edition. Boca Raton: Chapman and Hall/CRC. ISBN 0-412-31760-5. 11 Jørgensen, B. (1992). The theory of exponential dispersion models and analysis of deviance. Monografias de matemática, no. 51. See also Exponential dispersion model. 1.1.12.1. Usage  TweedieRegressor implements a generalized linear model for the Tweedie distribution, that allows to model any of the above mentioned distributions using the appropriate parameter. In particular: : Normal distribution. Specific estimators such as Ridge , ElasticNet are generally more appropriate in this case. : Poisson distribution. PoissonRegressor is exposed for convenience. However, it is strictly equivalent to . : Gamma distribution. GammaRegressor is exposed for convenience. However, it is strictly equivalent to . : Inverse Gaussian distribution. The link function is determined by the parameter. Usage example: Examples: Poisson regression and non-normal loss Tweedie regression on insurance claims 1.1.12.2. Practical considerations  The feature matrix should be standardized before fitting. This ensures that the penalty treats features equally. Since the linear predictor can be negative and Poisson, Gamma and Inverse Gaussian distributions don’t support negative values, it is necessary to apply an inverse link function that guarantees the non-negativeness. For example with , the inverse link function becomes . If you want to model a relative frequency, i.e. counts per exposure (time, volume, …) you can do so by using a Poisson distribution and passing as target values together with as sample weights. For a concrete example see e.g. Tweedie regression on insurance claims . When performing cross-validation for the parameter of , it is advisable to specify an explicit function, because the default scorer TweedieRegressor.score is a function of itself. 